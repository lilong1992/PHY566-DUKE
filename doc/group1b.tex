\documentclass{article}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amsmath}
\geometry{left=1.8cm,right=1.8cm,top=1.5cm,bottom=1.5cm}
\parindent=0pt

\begin{document}
\title{\textbf{Computational Physics Group Assignment 1}}
\author{Christopher Flower, Long Li, Shen Yan, Wenzhe Yu}
\maketitle

\section{Introduction}
In this work, the 2D random walk, diffusion equation, and mixing of two gases are studied by Python programs.

\section{2D Random Walk}
A 2-dimensional random walker is a point continuously taking steps of unit length in $\pm x$ or $\pm y$ direction on a discrete square lattice. Random walkers taking up to 100 steps are simulated, then the properties of 2D random walk are investigated by averaging over $10^4$ walks.\\
\\
The average of x-coordinate $<x_n>$, of the square of x-coordinate $<(X_n)^2>$, and of the square distance $<(r_n)^2>$ of random walks with different steps are plotted in figure~\ref{random} (a), (b), and (c), respectively. $<x_n>$ oscillates around zero, consistent with the theoretical expectation. $<(x_n)^2>$, by contrast, increases with steps with a slope of $\frac{1}{2}$.\\
\\
Figure~\ref{random} (c) shows that $<(r_n)^2>$ increases with steps as well, with a slope of $1$. This can be explained by the symmetry between  $<(y_n)^2>$ and $<(x_n)^2>$, leading the slope of $<(r_n)^2>$ be $\frac{1}{2}+\frac{1}{2} = 1$.\\

\begin{figure}[h!]
\centering
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{xaverage.pdf}
\caption{$<x_n>$ versus steps n}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{x2average.pdf}
\caption{$<(x_n)^2>$ versus steps n}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{r2average.pdf}
\caption{$<(r_n)^2>$ versus steps n}
\end{subfigure}
\caption{$<x_n>$, $<(x_n)^2>$, and $<(r_n)^2>$ of 2D random walk.}
\label{random}
\end{figure}

\section{Diffusion Equation}
Consider the 1D Normal Distribution\\

\begin{equation}
\rho(x,t) = \frac{1}{\sqrt{2\pi \sigma^2 (t)}} e^{-\frac{x^2}{2\sigma^2(t)}}
\end{equation}

The spatial expectation value $<x^2(t)>$ can be computed by

\begin{align*}
<x^2(t)> & = \int_{-\infty}^{\infty} x^2 \rho(x,t) dt \\
& = \frac{1}{\sqrt{2\pi \sigma^2 (t)}} \int_{-\infty}^{\infty} x^2 e^{-\frac{x^2}{2\sigma^2(t)}} dx \\
& = \frac{1}{\sqrt{2\pi \sigma^2 (t)}} \frac{1}{2} (\sqrt{2} \sigma(t))^3 \sqrt{\pi} \\
& = \sigma^2 (t)
\end{align*}

Here $\int_{-\infty}^{\infty} x^{2k} e^{-\frac{x^2}{a^2}} dx = \frac{(2k+1)!!}{(2k+1)2^k} a^{2k+1} \sqrt{\pi}\ (k=0,1,2,...)$ is used.\\
\\
The diffusion equation with a constant diffusion coefficient has the following form:

\begin{equation}
\frac{\partial u (r,t)}{\partial t} = D \nabla^2 u(r,t)
\end{equation}

In one-dimensional case, equation (2) becomes\\

\begin{equation}
\frac{\partial u (r,t)}{\partial t} = D \frac{\partial^2 u(x,t)}{\partial x^2}
\end{equation}

The first derivative in time and second derivative in space can be approximated by the finite difference:\\

\begin{align*}
\frac{\partial u (r,t)}{\partial t} & = \frac{u(x,t+\Delta t) - u(x,t)}{\Delta t} \\
\frac{\partial^2 u(x,t)}{\partial x^2} & = \frac{u(x+\Delta x,t)+u(x-\Delta x,t)-2u(x,t)}{(\Delta x)^2}
\end{align*}

Then equation (3) can be rewritten as\\

\begin{equation*}
\frac{u(x,t+\Delta t) - u(x,t)}{\Delta t} = D \cdot \frac{u(x+\Delta x,t)+u(x-\Delta x,t)-2u(x,t)}{(\Delta x)^2}
\end{equation*}

or equivalently,\\

\begin{equation}
u(x,t+\Delta t) = u(x,t) + D \cdot \Delta t \cdot \frac{u(x+\Delta x,t)+u(x-\Delta x,t)-2u(x,t)}{(\Delta x)^2}
\end{equation}

Starting from an initial box density profile, the 1D diffusion equation (3) is numerically solved based on equation (4). The density profile at later times is plotted in figure~\ref{diffusion}. The density are normally distributed, with different standard deviation $\sigma$. The value of $\sigma$ at time t is obtained through Gaussian fitting. Figure~\ref{sigma} (a) shows the comparison between the fitted $\sigma$ and the theoretical values calculated by $\sigma(t) = \sqrt{2Dt}$. The fitted values of $\sigma$ agrees well with the theoretical values.

\begin{figure}[h!]
\centering
\includegraphics[width=0.45\textwidth]{diffusion.pdf}
\caption{Solution of 1D diffusion equation at time 0, 0.2, 0.4, 0.6, 0.8, 1.0.}
\label{diffusion}
\end{figure}

\begin{figure}[h!]
\centering
\begin{subfigure}[b]{0.36\textwidth}
\includegraphics[width=\textwidth]{gaussianfit.pdf}
\caption{Gaussian fitted $\sigma$}
\end{subfigure}
\begin{subfigure}[b]{0.36\textwidth}
\includegraphics[width=\textwidth]{sigma.pdf}
\caption{$\sigma$ versus t (log plot)}
\end{subfigure}
\caption{Comparison between calculated $\sigma$ and $\sigma(t) = \sqrt{2Dt}$.}
\label{sigma}
\end{figure}

$\sigma(t) = \sqrt{2Dt}$ is verified by $\sigma$ directly extracted from the maximum value of density $u_{max}$ at $x=0$.\\

\begin{align*}
u_{max} (t) & = \rho(0,t) = \frac{1}{\sqrt{2\pi \sigma^2 (t)}} \\
\Rightarrow \sigma(t) & = \frac{1}{\sqrt{2\pi u_{max}^2 (t)}}
\end{align*}

The maximum values $u_{max}$ and derived $sigma$ at time 0.2, 0.4, 0.6, 0.8, 1.0 are listed in table 1. The $\sigma (t)$ versus time t is plotted (log scale) in figure~\ref{sigma} (b) with a linear fit line, which has a scope of 0.478. This indicates that $\sigma(t) \propto \sqrt{t}$.\\

\begin{table}[!ht]
\begin{center}
\caption{$u_{max}$ at time 0.2, 0.4, 0.6, 0.8, 1.0.}
\begin{tabular}{ l | c | c | c | c | c }
\hline
t & 0.2 & 0.4 & 0.6 & 0.8 & 1.0 \\ \hline
$u_{max}$ & 22.1449 & 16.0971 & 13.2666 & 11.5433 & 10.3539 \\ \hline
$\sigma$ [$\times 10^{-2}$] & 1.8015 & 2.4783 & 3.0071 & 3.4560 & 3.8531 \\ \hline
\end{tabular}
\end{center}
\label{umax}
\end{table}

\section{Mixing of two Gases}
The mixing of two gases can be simulated with a number of random walkers. For simplicity, a 2D rectangular enclosure with dimensions $400 \times 600$ is studied. The initial profile is set up by fully populating the left third of the box with gas A and the right third with gas B.\\
\\
Then a grid point is selected randomly, to perform a one-step random move. The move will be accepted if the destination is not occupied by another particle and is inside the box; it will be rejected if the destination is occupied or outside the box.\\
\\
This process is iterated for sufficient times. The configurations after different number of random moves are plotted in figure~\ref{configurations}. In figure~\ref{configurations} (f), A and B gases are fully mixed. The status of mixing is more visible by the linear population densities, as shown in figure~\ref{densities}. A and B gases are separated at the beginning (figure~\ref{densities} (a)). Finally the distribution of each gas is virtually uniform along the x direction (figure~\ref{densities} (f)).\\

\begin{figure}[h!]
\centering
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{snapshot_0.pdf}
%\caption{$n = 0$}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{snapshot_1.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{snapshot_2.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{snapshot_3.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{snapshot_4.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{snapshot_5.pdf}
%\caption{$n = $}
\end{subfigure}
\caption{Gases mixing configurations after different number of steps.}
\label{configurations}
\end{figure}

\begin{figure}[h!]
\centering
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{densities_0.pdf}
%\caption{$n = 0$}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{densities_1.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{densities_2.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{densities_3.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{densities_4.pdf}
%\caption{$n = $}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\includegraphics[width=\textwidth]{densities_5.pdf}
%\caption{$n = $}
\end{subfigure}
\caption{Linear population densities after different number of steps.}
\label{densities}
\end{figure}

In principle, two fully mixed gases should be uniformly distributed within the box. Due to the stochastic nature of the mixing simulation, the uniform distribution is never obtained by one single trial. The linear population densities averaged over 100 trials, illustrated in figure~\ref{average100}, show good agreement with the uniform distribution. The densities will gradually approach the perfect uniform distribution with increasing number of trials.

\begin{figure}[h!]
\centering
\includegraphics[width=0.45\textwidth]{densities_average.pdf}
\caption{Linear population densities averaged over 100 trials.}
\label{average100}
\end{figure}

\section{Conclusions}
In this work, the 2D random walk, diffusion equation, and mixing of two gases are studied by Python programs. $<x_n>$ of 2D random walk oscillates around zero, while $<(x_n)^2>$ and $<(r_n)^2>$ increases linearly with steps.\\
\\
The solutions of 1D diffusion equation with an initial box density profile are normal distributions. The standard variance $\sigma$ of the normal distribution is proportional to the square root of time $\sqrt{t}$.\\
\\
In the gases mixing simulation, two gases are fully mixed after a large number of iteration steps. The final linear population density of each gas averaged over 100 simulations is a uniform distribution.\\
\\
The source code of this work is downloadable online at github.com/vyu16/PHY566-DUKE.

\begin{thebibliography}{9}
\bibitem{notes}
Notes of \textbf{\textit{Computational Physics}} by Prof. S.A. Bass.
\end{thebibliography}

\end{document}
